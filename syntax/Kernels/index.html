<!DOCTYPE html><head><meta charset="UTF-8"><title>Kernels System | Moltres</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><link href="../../contrib/katex/katex.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/katex_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/moltres.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script><script type="text/javascript" src="../../contrib/katex/katex.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down">Moltres</a><a href="https://github.com/arfc/moltres" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="041dcd2a-d7d2-4515-ba44-dc5f65b76343" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="71076b58-c34f-474a-9f60-b2c78862053b" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="4301c6ad-5d74-46c2-b10c-22757e9e1278" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#" class="sidenav-trigger" data-target="08537bae-a1ca-43b6-9e23-636acf804c0c"><i class="material-icons">menu</i></a><ul class="sidenav" id="08537bae-a1ca-43b6-9e23-636acf804c0c"><li><a href="#!" class="dropdown-trigger" data-target="1554ffd0-98aa-4e09-8269-e17afb47bfca" data-constrainWidth="false">Getting Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="8db7bcdb-c306-423d-8f18-55440129474d" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="c69cd2f2-6d2b-4a73-8b94-375d17bf7978" data-constrainWidth="false">Help<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../citing.html">Citing</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="041dcd2a-d7d2-4515-ba44-dc5f65b76343"><li><a href="../../getting_started/installation.html">Install Moltres</a></li><li><a href="../../getting_started/tutorials.html">Tutorials</a></li></ul><ul class="dropdown-content" id="71076b58-c34f-474a-9f60-b2c78862053b"><li><a href="../index.html">Moltres Syntax</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Syntax</a></li><li><a href="../../doxygen/classes.html">Moltres Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="../../development/contributing.html">Contributing</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="4301c6ad-5d74-46c2-b10c-22757e9e1278"><li><a href="https://github.com/arfc/moltres/discussions">Moltres Discussion Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussion Forum</a></li></ul><ul class="dropdown-content" id="1554ffd0-98aa-4e09-8269-e17afb47bfca"><li><a href="../../getting_started/installation.html">Install Moltres</a></li><li><a href="../../getting_started/tutorials.html">Tutorials</a></li></ul><ul class="dropdown-content" id="8db7bcdb-c306-423d-8f18-55440129474d"><li><a href="../index.html">Moltres Syntax</a></li><li><a href="https://mooseframework.inl.gov/source/index.html">MOOSE Syntax</a></li><li><a href="../../doxygen/classes.html">Moltres Doxygen</a></li><li><a href="https://mooseframework.inl.gov/docs/doxygen/moose/classes.html">MOOSE Doxygen</a></li><li><a href="../../development/contributing.html">Contributing</a></li><li><a href="../../publications.html">List of Publications</a></li></ul><ul class="dropdown-content" id="c69cd2f2-6d2b-4a73-8b94-375d17bf7978"><li><a href="https://github.com/arfc/moltres/discussions">Moltres Discussion Forum</a></li><li><a href="https://github.com/idaholab/moose/discussions">MOOSE Discussion Forum</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="row"><div class="col l12"><div class="input-field"><input type_="text" onkeyup="mooseSearch()" placeholder="/index.md" id="moose-search-box"></input></div></div><div><div class="col s12" id="moose-search-results"></div></div></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="col hide-on-med-and-down l12"><nav class="breadcrumb-nav"><div class="nav-wrapper"><a href=".." class="breadcrumb">syntax</a><a href="." class="breadcrumb">Kernels</a></div></nav></div></div><div class="row"><div class="moose-content col s12 m12 l10"><section id="503ebfd1-dae9-43e0-9777-6925db76a885" data-section-level="1" data-section-text="Kernels System"><h1 id="kernels-system">Kernels System</h1><p>A &quot;Kernel&quot; is a piece of physics. It can represent one or more operators or terms in the weak form of a partial differential equation.  With all terms on the left-hand-side, their sum is referred to as the &quot;residual&quot;. The residual is evaluated at several integration quadrature points over the problem domain. To implement your own physics in MOOSE, you create your own kernel by subclassing the MOOSE <code>Kernel</code> class.</p><p>The Kernel system supports the use of <span class="tooltipped" data-tooltip="automatic differentiation" data-position="top" data-delay="50">AD</span> for residual calculations, as such there are two options for creating Kernel objects: <code>Kernel</code> and <code>ADKernel</code>. To further understand automatic differentiation, please refer to the <a href="../../automatic_differentiation/index.html">Automatic Differentiation</a> page for more information.</p><p>In a <code>Kernel</code> subclass the <code>computeQpResidual()</code> function <strong>must</strong> be overridden.  This is where you implement your PDE weak form terms.  For non-AD objects the following member functions can optionally be overridden:</p><ul class="browser-default"><li><p><code>computeQpJacobian()</code> </p></li><li><p><code>computeQpOffDiagJacobian()</code></p></li></ul><p>These two functions provide extra information that can help the numerical solver(s) converge faster and better.</p><p>Inside your Kernel class, you have access to several member variables for computing the residual and Jacobian values in the above mentioned functions:</p><ul class="browser-default"><li><p><code>_i</code>, <code>_j</code>: indices for the current test and trial shape functions respectively. </p></li><li><p><code>_qp</code>: current quadrature point index. </p></li><li><p><code>_u</code>, <code>_grad_u</code>: value and gradient of the variable this Kernel operates on; indexed by <code>_qp</code> (i.e. <code>_u[_qp]</code>). </p></li><li><p><code>_test</code>, <code>_grad_test</code>: value (<span class="moose-katex-inline-equation" id="moose-equation-0d83e793-6944-4f7e-9f13-fc9dbc9f1b94"><script>var element = document.getElementById("moose-equation-0d83e793-6944-4f7e-9f13-fc9dbc9f1b94");katex.render("\\psi", element, {displayMode:false,throwOnError:false});</script></span>) and gradient (<span class="moose-katex-inline-equation" id="moose-equation-e17fb40f-b259-4a70-9ae4-da482d3a4497"><script>var element = document.getElementById("moose-equation-e17fb40f-b259-4a70-9ae4-da482d3a4497");katex.render("\\nabla \\psi", element, {displayMode:false,throwOnError:false});</script></span>) of the test functions at the q-points; indexed by <code>_i</code> and then <code>_qp</code> (i.e., <code>_test[_i][_qp]</code>). </p></li><li><p><code>_phi</code>, <code>_grad_phi</code>: value (<span class="moose-katex-inline-equation" id="moose-equation-7960ee06-bca2-407b-b47f-648752b1ba10"><script>var element = document.getElementById("moose-equation-7960ee06-bca2-407b-b47f-648752b1ba10");katex.render("\\phi", element, {displayMode:false,throwOnError:false});</script></span>) and gradient (<span class="moose-katex-inline-equation" id="moose-equation-572f14a1-b7d1-4546-b649-32c49de12643"><script>var element = document.getElementById("moose-equation-572f14a1-b7d1-4546-b649-32c49de12643");katex.render("\\nabla \\phi", element, {displayMode:false,throwOnError:false});</script></span>) of the   trial functions at the q-points; indexed by <code>_j</code> and then <code>_qp</code> (i.e., <code>_phi[_j][_qp]</code>). </p></li><li><p><code>_q_point</code>: XYZ coordinates of the current quadrature point. </p></li><li><p><code>_current_elem</code>: pointer to the current element being operated on.</p></li></ul><section class="scrollspy" id="88398ae7-09a4-4454-914b-bc7d2f5f1545" data-section-level="2" data-section-text="Optimized Kernel Objects"><h2 id="optimized">Optimized Kernel Objects</h2><p>Depending on the residual calculation being performed it is sometimes possible to optimize the calculation of the residual by precomputing values during the finite element assembly of the residual vector. The following table details the various Kernel base classes that can be used for as base classes to improve performance.</p><div form="['left', 'left', 'left']" recursive class="moose-table-div"><table><thead><tr><th style=";text-align:left">Base</th><th style=";text-align:left">Override</th><th style=";text-align:left">Use</th></tr></thead><tbody><tr><td style=";text-align:left">Kernel<br><strong>ADKernel</strong></td><td style=";text-align:left">computeQpResidual</td><td style=";text-align:left">Use when the term in the <span>partial differential equation (PDE)</span> is multiplied by both the test function and the gradient of the test function (<code>_test</code> and <code>_grad_test</code> must be applied)</td></tr></tbody><tbody><tr><td style=";text-align:left">KernelValue<br><strong>ADKernelValue</strong></td><td style=";text-align:left">precomputeQpResidual</td><td style=";text-align:left">Use when the term computed in the <span class="tooltipped" data-tooltip="partial differential equation" data-position="top" data-delay="50">PDE</span> is only multiplied by the test function (do not use <code>_test</code> in the override, it is applied automatically)</td></tr></tbody><tbody><tr><td style=";text-align:left">KernelGrad<br><strong>ADKernelGrad</strong></td><td style=";text-align:left">precomputeQpResidual</td><td style=";text-align:left">Use when the term computed in the <span class="tooltipped" data-tooltip="partial differential equation" data-position="top" data-delay="50">PDE</span> is only multiplied by the gradient of the test function (do not use <code>_grad_test</code> in the override, it is applied automatically)</td></tr></tbody></table></div></section><section class="scrollspy" id="3ee8c613-2269-43ec-bc7a-fd26fbdf1d87" data-section-level="2" data-section-text="Custom Kernel Creation"><h2 id="custom-kernel-creation">Custom Kernel Creation</h2><p>To create a custom kernel, you can follow the pattern of the <a href="../../source/kernels/Diffusion.html"><code>Diffusion</code></a> or <a href="../../source/kernels/ADDiffusion.html"><code>ADDiffusion</code></a> objects implemented and included in the MOOSE framework. Additionally, Example 2 in MOOSE provides a step-by-step overview of creating your own custom kernel. The following describes that calculation of the diffusion term of a PDE.</p><p>The strong-form of the diffusion equation is defined on a 3-D domain <span class="moose-katex-inline-equation" id="moose-equation-df8dd646-341c-420d-a30b-39b5a1911b46"><script>var element = document.getElementById("moose-equation-df8dd646-341c-420d-a30b-39b5a1911b46");katex.render("\\Omega", element, {displayMode:false,throwOnError:false});</script></span> as: find <span class="moose-katex-inline-equation" id="moose-equation-a0c2bb76-9880-4e37-aae2-782e16140329"><script>var element = document.getElementById("moose-equation-a0c2bb76-9880-4e37-aae2-782e16140329");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> such that</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-0c60a589-1438-47ea-8701-97e592bba239"></span><span class="moose-katex-equation-number">(1)</span><script>var element = document.getElementById("moose-equation-0c60a589-1438-47ea-8701-97e592bba239");katex.render("\\begin{aligned} -\\nabla\\cdot\\nabla u &= 0 \\in \\Omega\\\\ u|_{\\partial\\Omega_1} &= g_1\\\\ \\nabla u\\cdot \\hat{n} |_{\\partial\\Omega_2} &= g_2, \\end{aligned}", element, {displayMode:true,throwOnError:false});</script></span><p>where <span class="moose-katex-inline-equation" id="moose-equation-ef4429a9-62f7-4551-96fb-7b5a16f5212b"><script>var element = document.getElementById("moose-equation-ef4429a9-62f7-4551-96fb-7b5a16f5212b");katex.render("\\partial\\Omega_1", element, {displayMode:false,throwOnError:false});</script></span> is defined as the boundary on which the value of <span class="moose-katex-inline-equation" id="moose-equation-3a534fa6-fc34-4451-8c8d-9b7367011c57"><script>var element = document.getElementById("moose-equation-3a534fa6-fc34-4451-8c8d-9b7367011c57");katex.render("u", element, {displayMode:false,throwOnError:false});</script></span> is fixed to a known constant <span class="moose-katex-inline-equation" id="moose-equation-17c46716-eaad-414d-8939-b8ee16c2b8b8"><script>var element = document.getElementById("moose-equation-17c46716-eaad-414d-8939-b8ee16c2b8b8");katex.render("g_1", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-0015ac55-46bc-477a-b485-128ca200bf3a"><script>var element = document.getElementById("moose-equation-0015ac55-46bc-477a-b485-128ca200bf3a");katex.render("\\partial\\Omega_2", element, {displayMode:false,throwOnError:false});</script></span> is defined as the boundary on which the flux across the boundary is fixed to a known constant <span class="moose-katex-inline-equation" id="moose-equation-f19ca281-a6b6-4f96-85a5-ccba38c266a8"><script>var element = document.getElementById("moose-equation-f19ca281-a6b6-4f96-85a5-ccba38c266a8");katex.render("g_2", element, {displayMode:false,throwOnError:false});</script></span>, and <span class="moose-katex-inline-equation" id="moose-equation-35fa13d8-c100-4d83-824c-4813cd585872"><script>var element = document.getElementById("moose-equation-35fa13d8-c100-4d83-824c-4813cd585872");katex.render("\\hat{n}", element, {displayMode:false,throwOnError:false});</script></span> is the boundary outward normal.</p><p>The weak form is generated by multiplying by a test function (<span class="moose-katex-inline-equation" id="moose-equation-453cfe1e-7ed6-4188-921f-cc7e426c3266"><script>var element = document.getElementById("moose-equation-453cfe1e-7ed6-4188-921f-cc7e426c3266");katex.render("\\psi_i", element, {displayMode:false,throwOnError:false});</script></span>) and integrating over the domain (using inner-product notation):</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-0297266d-8f8c-4fea-b346-dc0e5eac38ae"></span><script>var element = document.getElementById("moose-equation-0297266d-8f8c-4fea-b346-dc0e5eac38ae");katex.render("(-\\nabla\\cdot\\nabla u_h, \\psi_i) = 0\\quad \\forall\\,\\psi_i", element, {displayMode:true,throwOnError:false});</script></span><p>and then integrating by parts which gives the weak form:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-73191422-6a4c-4953-b356-dbeab301dfaa"></span><span class="moose-katex-equation-number">(2)</span><script>var element = document.getElementById("moose-equation-73191422-6a4c-4953-b356-dbeab301dfaa");katex.render("(\\nabla u_h, \\nabla \\psi_i) - \\langle g_2, \\psi_i\\rangle = 0\\quad \\forall\\,\\psi_i,", element, {displayMode:true,throwOnError:false});</script></span><p>where <span class="moose-katex-inline-equation" id="moose-equation-1409beaa-7b19-4fc4-945c-3be18fbe0564"><script>var element = document.getElementById("moose-equation-1409beaa-7b19-4fc4-945c-3be18fbe0564");katex.render("u_h", element, {displayMode:false,throwOnError:false});</script></span> is known as the trial function that defines the finite element discretization, <span class="moose-katex-inline-equation" id="moose-equation-e29b9419-60ba-48a2-a3eb-4e881edb775a"><script>var element = document.getElementById("moose-equation-e29b9419-60ba-48a2-a3eb-4e881edb775a");katex.render("u \\approx u_h = \\sum_{j=1}^N u_j \\phi_j", element, {displayMode:false,throwOnError:false});</script></span>, with <span class="moose-katex-inline-equation" id="moose-equation-044f186b-c469-4365-af6f-6fc54b40c7ff"><script>var element = document.getElementById("moose-equation-044f186b-c469-4365-af6f-6fc54b40c7ff");katex.render("\\phi_j", element, {displayMode:false,throwOnError:false});</script></span> being the basis functions.</p><p>The Jacobian, which is the derivative of <a href="#moose-equation-73191422-6a4c-4953-b356-dbeab301dfaa">Eq. (2)</a> with respect to <span class="moose-katex-inline-equation" id="moose-equation-4852fb64-eea8-4edc-bad5-7d1ac0075a58"><script>var element = document.getElementById("moose-equation-4852fb64-eea8-4edc-bad5-7d1ac0075a58");katex.render("u_j", element, {displayMode:false,throwOnError:false});</script></span> <span class="moose-katex-inline-equation" id="moose-equation-0dcdcbb5-b7b9-4d77-9a78-2fadf48d9248"><script>var element = document.getElementById("moose-equation-0dcdcbb5-b7b9-4d77-9a78-2fadf48d9248");katex.render("\\left(\\frac{\\partial (.)}{\\partial u_j}\\right)", element, {displayMode:false,throwOnError:false});</script></span>, is defined as:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-5e8e77fa-d49c-43bf-9e46-a54663b6f3ad"></span><span class="moose-katex-equation-number">(3)</span><script>var element = document.getElementById("moose-equation-5e8e77fa-d49c-43bf-9e46-a54663b6f3ad");katex.render("(\\nabla \\phi_j, \\nabla \\psi_i)\\quad \\forall\\,\\psi_i", element, {displayMode:true,throwOnError:false});</script></span><p>As mentioned, the <code>computeQpResidual</code> method must be overridden for both flavors of kernels non-AD and AD. The <code>computeQpResidual</code> method for the non-AD version, <a href="../../source/kernels/Diffusion.html"><code>Diffusion</code></a>, is provided in <a href="#non-ad-residual">Listing 1</a>.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 1: </span><span class="moose-caption-text">The C++ weak-form residual statement of <a href="#moose-equation-73191422-6a4c-4953-b356-dbeab301dfaa">Eq. (2)</a> as implemented in the Diffusion kernel.</span></p><pre class="moose-pre" style="max-height:350px;"><code class="language-cpp">Real
Diffusion::computeQpResidual()
{
  return _grad_u[_qp] * _grad_test[_i][_qp];
}
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#e85f7fb2-b84a-4ed8-a15d-52c8eed75e5d">(moose/framework/src/kernels/Diffusion.C)</a></div></div><p>This object also overrides the <code>computeQpJacobian</code> method to define Jacobian term of <a class="moose-source-filename tooltipped modal-trigger" href="#c3865413-beff-40dc-b386-7572d41c8e0b">(doc/jacobian)</a> as shown in <a href="#non-ad-jacobian">Listing 2</a>.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 2: </span><span class="moose-caption-text">The C++ weak-form Jacobian statement of <a class="moose-source-filename tooltipped modal-trigger" href="#7f5f688e-ab57-49a5-bb49-cc7e07a0965c">(doc/jacobian)</a> as implemented in the Diffusion kernel.</span></p><pre class="moose-pre" style="max-height:350px;"><code class="language-cpp">Real
Diffusion::computeQpJacobian()
{
  return _grad_phi[_j][_qp] * _grad_test[_i][_qp];
}
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#af5ff740-156d-426c-b4c7-0580d797062e">(moose/framework/src/kernels/Diffusion.C)</a></div></div><p>The AD version of this object, <a href="../../source/kernels/ADDiffusion.html"><code>ADDiffusion</code></a>, relies on an optimized kernel object (see <a href="index.html#optimized">Optimized Kernel Objects</a>), as such it overrides <code>precomputeQpResidual</code> as follows.</p><div class="card moose-float"><div class="card-content"><p class="moose-caption"><span class="moose-caption-heading">Listing 3: </span><span class="moose-caption-text">The C++ pre-computed portions of the weak-form residual statement of <a href="#moose-equation-73191422-6a4c-4953-b356-dbeab301dfaa">Eq. (2)</a> as implemented in the ADDiffusion kernel.</span></p><pre class="moose-pre" style="max-height:350px;"><code class="language-cpp">ADDiffusion::precomputeQpResidual()
{
  return _grad_u[_qp];
}
</code></pre><a class="moose-source-filename tooltipped modal-trigger" href="#f04cdc76-318c-414e-a573-18fe4daf87cc">(moose/framework/src/kernels/ADDiffusion.C)</a></div></div></section><section class="scrollspy" id="460b7891-8845-40b5-a730-87d1f89937f8" data-section-level="2" data-section-text="Time Derivative Kernels"><h2 id="time-derivative-kernels">Time Derivative Kernels</h2><p>You can create a time-derivative term/kernel by subclassing <code>TimeKernel</code> instead of <code>Kernel</code>.  For example, the residual contribution for a time derivative term is:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-49444450-c875-4520-8339-ecb54cc4f70b"></span><script>var element = document.getElementById("moose-equation-49444450-c875-4520-8339-ecb54cc4f70b");katex.render("\\left(\\frac{\\partial u_h}{\\partial t}, \\psi_i\\right)", element, {displayMode:true,throwOnError:false});</script></span><p>where <span class="moose-katex-inline-equation" id="moose-equation-c4fd777b-e54b-4713-bb75-7414e7ca7bd2"><script>var element = document.getElementById("moose-equation-c4fd777b-e54b-4713-bb75-7414e7ca7bd2");katex.render("u_h", element, {displayMode:false,throwOnError:false});</script></span> is the finite element solution, and</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-15951e6a-ed8b-4d54-8826-67544615e790"></span><span class="moose-katex-equation-number">(4)</span><script>var element = document.getElementById("moose-equation-15951e6a-ed8b-4d54-8826-67544615e790");katex.render("\\frac{\\partial u_h}{\\partial t} \\equiv \\frac{\\partial}{\\partial t} \\left(     \\sum_k u_k \\phi_k \\right) = \\sum_k \\frac{\\partial u_k}{\\partial t} \\phi_k", element, {displayMode:true,throwOnError:false});</script></span><p>because you can interchange the order of differentiation and summation.</p><p>In the equation above, <span class="moose-katex-inline-equation" id="moose-equation-8e374d56-4c8d-4e1b-990c-ae9282211e91"><script>var element = document.getElementById("moose-equation-8e374d56-4c8d-4e1b-990c-ae9282211e91");katex.render("\\frac{\\partial u_k}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span> is the time derivative of the <span class="moose-katex-inline-equation" id="moose-equation-ebe1b74c-c2e8-48e8-ac34-c9459668827b"><script>var element = document.getElementById("moose-equation-ebe1b74c-c2e8-48e8-ac34-c9459668827b");katex.render("k", element, {displayMode:false,throwOnError:false});</script></span>th finite element coefficient of <span class="moose-katex-inline-equation" id="moose-equation-acb36a46-5b7e-416b-a913-b6af4c3a15f9"><script>var element = document.getElementById("moose-equation-acb36a46-5b7e-416b-a913-b6af4c3a15f9");katex.render("u_h", element, {displayMode:false,throwOnError:false});</script></span>. While the exact form of this derivative depends on the time stepping scheme, without much loss of generality, we can assume the following form for the time derivative:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-9c899f39-31fb-409c-b73c-140803b53b97"></span><script>var element = document.getElementById("moose-equation-9c899f39-31fb-409c-b73c-140803b53b97");katex.render("\\frac{\\partial u_k}{\\partial t} = a u_k + b", element, {displayMode:true,throwOnError:false});</script></span><p>for some constants <span class="moose-katex-inline-equation" id="moose-equation-75a12ac6-bc2b-4bb0-8a47-7e55d32500d9"><script>var element = document.getElementById("moose-equation-75a12ac6-bc2b-4bb0-8a47-7e55d32500d9");katex.render("a", element, {displayMode:false,throwOnError:false});</script></span>, <span class="moose-katex-inline-equation" id="moose-equation-9b922552-40c5-43ff-beb5-c224b6b67f19"><script>var element = document.getElementById("moose-equation-9b922552-40c5-43ff-beb5-c224b6b67f19");katex.render("b", element, {displayMode:false,throwOnError:false});</script></span> which depend on <span class="moose-katex-inline-equation" id="moose-equation-babad487-1560-4d2b-a873-9a1fe2845eba"><script>var element = document.getElementById("moose-equation-babad487-1560-4d2b-a873-9a1fe2845eba");katex.render("\\Delta t", element, {displayMode:false,throwOnError:false});</script></span> and the timestepping method.</p><p>The derivative of equation <a href="#moose-equation-15951e6a-ed8b-4d54-8826-67544615e790">Eq. (4)</a> with respect to <span class="moose-katex-inline-equation" id="moose-equation-3d3ed453-ce48-4186-896f-c58c11730d38"><script>var element = document.getElementById("moose-equation-3d3ed453-ce48-4186-896f-c58c11730d38");katex.render("u_j", element, {displayMode:false,throwOnError:false});</script></span> is then:</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-c350cffc-4cc3-447b-80c0-9029d2ea751e"></span><script>var element = document.getElementById("moose-equation-c350cffc-4cc3-447b-80c0-9029d2ea751e");katex.render("\\frac{\\partial}{\\partial u_j} \\left(     \\sum_k \\frac{\\partial u_k}{\\partial t} \\phi_k \\right) = \\frac{\\partial }{\\partial u_j} \\left(     \\sum_k (a u_k + b) \\phi_k \\right)  = a \\phi_j", element, {displayMode:true,throwOnError:false});</script></span><p>So that the Jacobian term for equation <a href="#moose-equation-15951e6a-ed8b-4d54-8826-67544615e790">Eq. (4)</a> is</p><span class="moose-katex-block-equation"><span class="moose-katex-equation table-cell" id="moose-equation-e928b44f-83e0-4555-b217-f14f2fd9b057"></span><script>var element = document.getElementById("moose-equation-e928b44f-83e0-4555-b217-f14f2fd9b057");katex.render("\\left(a \\phi_j, \\psi_i\\right)", element, {displayMode:true,throwOnError:false});</script></span><p>where <span class="moose-katex-inline-equation" id="moose-equation-8b6ba90e-0dba-4f65-93cc-b5702e01a6e5"><script>var element = document.getElementById("moose-equation-8b6ba90e-0dba-4f65-93cc-b5702e01a6e5");katex.render("a", element, {displayMode:false,throwOnError:false});</script></span> is what we call <code>du_dot_du</code> in MOOSE.</p><p>Therefore the <code>computeQpResidual()</code> function for our time-derivative term kernel looks like:</p><pre class="moose-pre"><code class="language-cpp">
return _test[_i][_qp] * _u_dot[_qp];
</code></pre><p>And the corresponding <code>computeQpJacobian()</code> is:</p><pre class="moose-pre"><code class="language-cpp">
return _test[_i][_qp] * _phi[_j][_qp] * _du_dot_du[_qp];
</code></pre></section><section class="scrollspy" id="f203d152-a590-4251-9265-fc193af42448" data-section-level="2" data-section-text="Further Kernel Documentation"><h2 id="further-kernel-documentation">Further Kernel Documentation</h2><p>Several specialized kernel types exist in MOOSE each with useful functionality.  Details for each are in the sections below.</p></section><section class="scrollspy" id="20c22409-3962-4e61-8b3f-5775eda2a6b7" data-section-level="2" data-section-text="Available Objects"><h2 id="available-objects">Available Objects</h2><ul class="moose-syntax-list collection with-header"><li class="collection-header">Moose App</li><li class="collection-item"><a href="../../source/kernels/BodyForce.html">ADBodyForce</a>Demonstrates the multiple ways that scalar values can be introduced into kernels, e.g. (controllable) constants, functions, and postprocessors. Implements the weak form <span class="moose-katex-inline-equation" id="moose-equation-70195b67-4476-4b09-b13a-4d88d3935e3d"><script>var element = document.getElementById("moose-equation-70195b67-4476-4b09-b13a-4d88d3935e3d");katex.render("(\\psi_i, -f)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ADCoupledForce.html">ADCoupledForce</a>Implements a source term proportional to the value of a coupled variable. Weak form: <span class="moose-katex-inline-equation" id="moose-equation-a3b693b6-3f90-49f8-bd5c-7b68a4f8e5a9"><script>var element = document.getElementById("moose-equation-a3b693b6-3f90-49f8-bd5c-7b68a4f8e5a9");katex.render("(\\psi_i, -\\sigma v)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ADCoupledTimeDerivative.html">ADCoupledTimeDerivative</a>Time derivative Kernel that acts on a coupled variable. Weak form: <span class="moose-katex-inline-equation" id="moose-equation-48e22c24-7de6-4145-8752-a6a3e316fe60"><script>var element = document.getElementById("moose-equation-48e22c24-7de6-4145-8752-a6a3e316fe60");katex.render("(\\psi_i, \\frac{\\partial v_h}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ADDiffusion.html">ADDiffusion</a>Same as <code>Diffusion</code> in terms of physics/residual, but the Jacobian is computed using forward automatic differentiation</li><li class="collection-item"><a href="../../source/kernels/ADMatDiffusion.html">ADMatDiffusion</a>Diffusion equation kernel that takes an isotropic diffusivity from a material property</li><li class="collection-item"><a href="../../source/kernels/MaterialPropertyValue.html">ADMaterialPropertyValue</a>Residual term (u - prop) to set variable u equal to a given material property prop</li><li class="collection-item"><a href="../../source/kernels/ADTimeDerivative.html">ADTimeDerivative</a>The time derivative operator with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-271030a8-646a-4d32-8b7f-15957333454b"><script>var element = document.getElementById("moose-equation-271030a8-646a-4d32-8b7f-15957333454b");katex.render("(\\psi_i, \\frac{\\partial u_h}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ADVectorDiffusion.html">ADVectorDiffusion</a>The Laplacian operator (<span class="moose-katex-inline-equation" id="moose-equation-9a036ba9-8d70-4c19-b490-248347a32216"><script>var element = document.getElementById("moose-equation-9a036ba9-8d70-4c19-b490-248347a32216");katex.render("-\\nabla \\cdot \\nabla \\vec{u}", element, {displayMode:false,throwOnError:false});</script></span>), with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-8bb99b47-2aa5-4ad5-9a25-a47bc6ef9b96"><script>var element = document.getElementById("moose-equation-8bb99b47-2aa5-4ad5-9a25-a47bc6ef9b96");katex.render("(\\nabla \\vec{\\phi_i}, \\nabla \\vec{u_h})", element, {displayMode:false,throwOnError:false});</script></span>. The Jacobian is computed using automatic differentiation</li><li class="collection-item"><a href="../../source/kernels/ADVectorTimeDerivative.html">ADVectorTimeDerivative</a>The time derivative operator with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-fdba5ce6-8fcd-4b5b-a5cd-4266382d4ee9"><script>var element = document.getElementById("moose-equation-fdba5ce6-8fcd-4b5b-a5cd-4266382d4ee9");katex.render("(\\psi_i, \\frac{\\partial u_h}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/AnisotropicDiffusion.html">AnisotropicDiffusion</a>Anisotropic diffusion kernel <span class="moose-katex-inline-equation" id="moose-equation-12979c68-200f-479f-8399-4c5fa66080df"><script>var element = document.getElementById("moose-equation-12979c68-200f-479f-8399-4c5fa66080df");katex.render("\\nabla \\cdot -\\widetilde{k} \\nabla u", element, {displayMode:false,throwOnError:false});</script></span> with weak form given by <span class="moose-katex-inline-equation" id="moose-equation-6cea91db-3baf-4e29-b621-ee0df8462c3c"><script>var element = document.getElementById("moose-equation-6cea91db-3baf-4e29-b621-ee0df8462c3c");katex.render("(\\nabla \\psi_i, \\widetilde{k} \\nabla u)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ArrayBodyForce.html">ArrayBodyForce</a>Applies body forces specified with functions to an array variable.</li><li class="collection-item"><a href="../../source/kernels/ArrayDiffusion.html">ArrayDiffusion</a>The array Laplacian operator (<span class="moose-katex-inline-equation" id="moose-equation-7cdc91f6-10b3-46da-bacc-b6076df46502"><script>var element = document.getElementById("moose-equation-7cdc91f6-10b3-46da-bacc-b6076df46502");katex.render("-\\nabla \\cdot \\nabla u", element, {displayMode:false,throwOnError:false});</script></span>), with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-7accecd8-af52-483e-8417-2a23562bbde9"><script>var element = document.getElementById("moose-equation-7accecd8-af52-483e-8417-2a23562bbde9");katex.render("(\\nabla \\phi_i, \\nabla u_h)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ArrayReaction.html">ArrayReaction</a>The array reaction operator with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-f9ea63b9-fa5e-44eb-9d97-7abc129481fe"><script>var element = document.getElementById("moose-equation-f9ea63b9-fa5e-44eb-9d97-7abc129481fe");katex.render("(\\psi_i, u_h)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ArrayTimeDerivative.html">ArrayTimeDerivative</a>Array time derivative operator with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-7a296fa2-1600-4c87-ae6c-699e2e345fd5"><script>var element = document.getElementById("moose-equation-7a296fa2-1600-4c87-ae6c-699e2e345fd5");katex.render("(\\psi_i, \\frac{\\partial u_h}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/BodyForce.html">BodyForce</a>Demonstrates the multiple ways that scalar values can be introduced into kernels, e.g. (controllable) constants, functions, and postprocessors. Implements the weak form <span class="moose-katex-inline-equation" id="moose-equation-3c81c88a-8ba7-4877-b22d-f412c8be7341"><script>var element = document.getElementById("moose-equation-3c81c88a-8ba7-4877-b22d-f412c8be7341");katex.render("(\\psi_i, -f)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/CoefReaction.html">CoefReaction</a>Implements the residual term (p*u, test)</li><li class="collection-item"><a href="../../source/kernels/CoefTimeDerivative.html">CoefTimeDerivative</a>The time derivative operator with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-1a927234-8437-45d1-9544-0887c8df921e"><script>var element = document.getElementById("moose-equation-1a927234-8437-45d1-9544-0887c8df921e");katex.render("(\\psi_i, \\frac{\\partial u_h}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ConservativeAdvection.html">ConservativeAdvection</a>Conservative form of <span class="moose-katex-inline-equation" id="moose-equation-b6403de6-20cb-490f-bea7-63247e76e932"><script>var element = document.getElementById("moose-equation-b6403de6-20cb-490f-bea7-63247e76e932");katex.render("\\nabla \\cdot \\vec{v} u", element, {displayMode:false,throwOnError:false});</script></span> which in its weak form is given by: <span class="moose-katex-inline-equation" id="moose-equation-b5cb7eac-9fd1-4e63-9280-ef45cb3a3e0f"><script>var element = document.getElementById("moose-equation-b5cb7eac-9fd1-4e63-9280-ef45cb3a3e0f");katex.render("(-\\nabla \\psi_i, \\vec{v} u)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/CoupledForce.html">CoupledForce</a>Implements a source term proportional to the value of a coupled variable. Weak form: <span class="moose-katex-inline-equation" id="moose-equation-30a32139-db5c-4a38-b71d-074b5643948a"><script>var element = document.getElementById("moose-equation-30a32139-db5c-4a38-b71d-074b5643948a");katex.render("(\\psi_i, -\\sigma v)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/CoupledTimeDerivative.html">CoupledTimeDerivative</a>Time derivative Kernel that acts on a coupled variable. Weak form: <span class="moose-katex-inline-equation" id="moose-equation-9114f5df-2a5f-478e-871f-41714657ca77"><script>var element = document.getElementById("moose-equation-9114f5df-2a5f-478e-871f-41714657ca77");katex.render("(\\psi_i, \\frac{\\partial v_h}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/Diffusion.html">Diffusion</a>The Laplacian operator (<span class="moose-katex-inline-equation" id="moose-equation-da58d888-6421-44b6-8e76-feac5d92ec4e"><script>var element = document.getElementById("moose-equation-da58d888-6421-44b6-8e76-feac5d92ec4e");katex.render("-\\nabla \\cdot \\nabla u", element, {displayMode:false,throwOnError:false});</script></span>), with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-b1dd6b8a-2421-4bf6-9985-ad12838ba476"><script>var element = document.getElementById("moose-equation-b1dd6b8a-2421-4bf6-9985-ad12838ba476");katex.render("(\\nabla \\phi_i, \\nabla u_h)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/MassEigenKernel.html">MassEigenKernel</a>An eigenkernel with weak form <span class="moose-katex-inline-equation" id="moose-equation-b9b473dd-d408-47c4-a42b-641a8c087878"><script>var element = document.getElementById("moose-equation-b9b473dd-d408-47c4-a42b-641a8c087878");katex.render("\\lambda(\\psi_i, -u_h)", element, {displayMode:false,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-5428a801-5618-46af-86fd-d23d1fd8d67e"><script>var element = document.getElementById("moose-equation-5428a801-5618-46af-86fd-d23d1fd8d67e");katex.render("\\lambda", element, {displayMode:false,throwOnError:false});</script></span> is the eigenvalue.</li><li class="collection-item"><a href="../../source/kernels/MassLumpedTimeDerivative.html">MassLumpedTimeDerivative</a>Lumped formulation of the time derivative <span class="moose-katex-inline-equation" id="moose-equation-d4a961f0-3688-4959-a765-c702a442b3f3"><script>var element = document.getElementById("moose-equation-d4a961f0-3688-4959-a765-c702a442b3f3");katex.render("\\frac{\\partial u}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span>. Its corresponding weak form is <span class="moose-katex-inline-equation" id="moose-equation-21847ae0-0e09-4eb8-9a51-67aa167f074e"><script>var element = document.getElementById("moose-equation-21847ae0-0e09-4eb8-9a51-67aa167f074e");katex.render("\\dot{u_i}(\\psi_i, 1)", element, {displayMode:false,throwOnError:false});</script></span> where <span class="moose-katex-inline-equation" id="moose-equation-0e834551-de5d-4af9-8924-062415799576"><script>var element = document.getElementById("moose-equation-0e834551-de5d-4af9-8924-062415799576");katex.render("\\dot{u_i}", element, {displayMode:false,throwOnError:false});</script></span> denotes the time derivative of the solution coefficient associated with node <span class="moose-katex-inline-equation" id="moose-equation-8f7e6f10-6ca1-4195-8488-8ec49bc164dc"><script>var element = document.getElementById("moose-equation-8f7e6f10-6ca1-4195-8488-8ec49bc164dc");katex.render("i", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/MatCoupledForce.html">MatCoupledForce</a>Implements a forcing term RHS of the form PDE = RHS, where RHS = Sum_j c_j * m_j * v_j. c_j, m_j, and v_j are provided as real coefficients, material properties, and coupled variables, respectively.</li><li class="collection-item"><a href="../../source/kernels/MatDiffusion.html">MatDiffusion</a>Diffusion equation Kernel that takes an isotropic Diffusivity from a material property</li><li class="collection-item"><a href="../../source/kernels/MatReaction.html">MatReaction</a>Kernel to add -L*v, where L=reaction rate, v=variable</li><li class="collection-item"><a href="../../source/kernels/MaterialDerivativeRankFourTestKernel.html">MaterialDerivativeRankFourTestKernel</a>Class used for testing derivatives of a rank four tensor material property.</li><li class="collection-item"><a href="../../source/kernels/MaterialDerivativeRankTwoTestKernel.html">MaterialDerivativeRankTwoTestKernel</a>Class used for testing derivatives of a rank two tensor material property.</li><li class="collection-item"><a href="../../source/kernels/MaterialDerivativeTestKernel.html">MaterialDerivativeTestKernel</a>Class used for testing derivatives of a scalar material property.</li><li class="collection-item"><a href="../../source/kernels/MaterialPropertyValue.html">MaterialPropertyValue</a>Residual term (u - prop) to set variable u equal to a given material property prop</li><li class="collection-item"><a href="../../source/kernels/NullKernel.html">NullKernel</a>Kernel that sets a zero residual.</li><li class="collection-item"><a href="../../source/kernels/Reaction.html">Reaction</a>Implements a simple consuming reaction term with weak form <span class="moose-katex-inline-equation" id="moose-equation-6b4ecad0-44a9-49c3-bdcd-b228186100e1"><script>var element = document.getElementById("moose-equation-6b4ecad0-44a9-49c3-bdcd-b228186100e1");katex.render("(\\psi_i, \\lambda u_h)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ScalarLagrangeMultiplier.html">ScalarLagrangeMultiplier</a>This class is used to enforce integral of phi = V_0 with a Lagrange multiplier approach.</li><li class="collection-item"><a href="../../source/kernels/TimeDerivative.html">TimeDerivative</a>The time derivative operator with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-d5af2420-6190-4123-9247-ecd015bd026b"><script>var element = document.getElementById("moose-equation-d5af2420-6190-4123-9247-ecd015bd026b");katex.render("(\\psi_i, \\frac{\\partial u_h}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/UserForcingFunction.html">UserForcingFunction</a>Demonstrates the multiple ways that scalar values can be introduced into kernels, e.g. (controllable) constants, functions, and postprocessors. Implements the weak form <span class="moose-katex-inline-equation" id="moose-equation-4916634f-3648-498f-ad2b-ecb3fef8b1e0"><script>var element = document.getElementById("moose-equation-4916634f-3648-498f-ad2b-ecb3fef8b1e0");katex.render("(\\psi_i, -f)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/VectorBodyForce.html">VectorBodyForce</a>Demonstrates the multiple ways that scalar values can be introduced into kernels, e.g. (controllable) constants, functions, and postprocessors. Implements the weak form <span class="moose-katex-inline-equation" id="moose-equation-03e026ab-c5e6-4d11-a67e-e9273889b920"><script>var element = document.getElementById("moose-equation-03e026ab-c5e6-4d11-a67e-e9273889b920");katex.render("(\\vec{\\psi_i}, -\\vec{f})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/VectorCoupledTimeDerivative.html">VectorCoupledTimeDerivative</a>Time derivative Kernel that acts on a coupled vector variable. Weak form: <span class="moose-katex-inline-equation" id="moose-equation-4d074840-641c-4612-854a-ab4d57b88eeb"><script>var element = document.getElementById("moose-equation-4d074840-641c-4612-854a-ab4d57b88eeb");katex.render("(\\vec{\\psi}_i, \\frac{\\partial \\vec{v_h}}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/VectorDiffusion.html">VectorDiffusion</a>The Laplacian operator (<span class="moose-katex-inline-equation" id="moose-equation-1743b896-4fbc-4cd4-a721-5dd17988b173"><script>var element = document.getElementById("moose-equation-1743b896-4fbc-4cd4-a721-5dd17988b173");katex.render("-\\nabla \\cdot \\nabla \\vec{u}", element, {displayMode:false,throwOnError:false});</script></span>), with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-e7e6156e-1684-4cb3-944c-c47436a4dfe9"><script>var element = document.getElementById("moose-equation-e7e6156e-1684-4cb3-944c-c47436a4dfe9");katex.render("(\\nabla \\vec{\\phi_i}, \\nabla \\vec{u_h})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/VectorTimeDerivative.html">VectorTimeDerivative</a>The time derivative operator with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-d4a0a71b-3e1a-41f8-ba80-f95daafd25b6"><script>var element = document.getElementById("moose-equation-d4a0a71b-3e1a-41f8-ba80-f95daafd25b6");katex.render("(\\vec{\\psi_i}, \\frac{\\partial \\vec{u_h}}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-header">Phase Field App</li><li class="collection-item">ACBarrierFunctionAllen-Cahn kernel used when &#x27;mu&#x27; is a function of variables</li><li class="collection-item">ACGBPolyGrain-Boundary model concentration dependent residual</li><li class="collection-item">ACGrGrElasticDrivingForceAdds elastic energy contribution to the Allen-Cahn equation</li><li class="collection-item">ACGrGrMultiMulti-phase poly-crystalline Allen-Cahn Kernel</li><li class="collection-item">ACGrGrPolyGrain-Boundary model poly-crystalline interface Allen-Cahn Kernel</li><li class="collection-item">ACInterfaceGradient energy Allen-Cahn Kernel</li><li class="collection-item">ACInterface2DMultiPhase1Gradient energy Allen-Cahn Kernel where the derivative of interface parameter kappa wrt the gradient of order parameter is considered.</li><li class="collection-item">ACInterface2DMultiPhase2Gradient energy Allen-Cahn Kernel where the interface parameter kappa is considered.</li><li class="collection-item">ACInterfaceCleavageFractureGradient energy Allen-Cahn Kernel where crack propagation along weakcleavage plane is preferred</li><li class="collection-item">ACInterfaceKobayashi1Anisotropic gradient energy Allen-Cahn Kernel Part 1</li><li class="collection-item">ACInterfaceKobayashi2Anisotropic Gradient energy Allen-Cahn Kernel Part 2</li><li class="collection-item">ACInterfaceStressInterface stress driving force Allen-Cahn Kernel</li><li class="collection-item">ACKappaFunctionGradient energy term for when kappa as a function of the variable</li><li class="collection-item">ACMultiInterfaceGradient energy Allen-Cahn Kernel with cross terms</li><li class="collection-item">ACSEDGPolyStored Energy contribution to grain growth</li><li class="collection-item">ACSwitchingKernel for Allen-Cahn equation that adds derivatives of switching functions and energies</li><li class="collection-item">ADACInterfaceGradient energy Allen-Cahn Kernel</li><li class="collection-item">ADACInterfaceKobayashi1Anisotropic gradient energy Allen-Cahn Kernel Part 1</li><li class="collection-item">ADACInterfaceKobayashi2Anisotropic Gradient energy Allen-Cahn Kernel Part 2</li><li class="collection-item">ADAllenCahnAllen-Cahn Kernel that uses a DerivativeMaterial Free Energy</li><li class="collection-item">ADCHSoretMobilityAdds contribution due to thermo-migration to the Cahn-Hilliard equation using a concentration &#x27;u&#x27;, temperature &#x27;T&#x27;, and thermal mobility &#x27;mobility&#x27; (in units of length squared per time).</li><li class="collection-item">ADCHSplitChemicalPotentialChemical potential kernel in Split Cahn-Hilliard that solves chemical potential in a weak form</li><li class="collection-item">ADCHSplitConcentrationConcentration kernel in Split Cahn-Hilliard that solves chemical potential in a weak form</li><li class="collection-item">ADCoefCoupledTimeDerivativeScaled time derivative Kernel that acts on a coupled variable</li><li class="collection-item">ADGrainGrowthGrain-Boundary model poly-crystalline interface Allen-Cahn Kernel</li><li class="collection-item">ADMatAnisoDiffusionDiffusion equation kernel that takes an anisotropic diffusivity from a material property</li><li class="collection-item">ADMatReactionKernel to add -L*v, where L=reaction rate, v=variable</li><li class="collection-item">ADSplitCHParsedSplit formulation Cahn-Hilliard Kernel that uses a DerivativeMaterial Free Energy</li><li class="collection-item">ADSplitCHWResSplit formulation Cahn-Hilliard Kernel for the chemical potential variable with a scalar (isotropic) mobility</li><li class="collection-item">ADSplitCHWResAnisoSplit formulation Cahn-Hilliard Kernel for the chemical potential variable with a scalar (isotropic) mobility</li><li class="collection-item">AllenCahnAllen-Cahn Kernel that uses a DerivativeMaterial Free Energy</li><li class="collection-item">AllenCahnElasticEnergyOffDiagThis kernel calculates off-diagonal Jacobian of elastic energy in AllenCahn with respect to displacements</li><li class="collection-item">AntitrappingCurrentKernel that provides antitrapping current at the interface for alloy solidification</li><li class="collection-item">CHBulkPFCTradCahn-Hilliard kernel for a polynomial phase field crystal free energy.</li><li class="collection-item">CHInterfaceGradient energy Cahn-Hilliard Kernel with a scalar (isotropic) mobility</li><li class="collection-item">CHInterfaceAnisoGradient energy Cahn-Hilliard Kernel with a tensor (anisotropic) mobility</li><li class="collection-item">CHMathSimple demonstration Cahn-Hilliard Kernel using an algebraic double-well potential</li><li class="collection-item">CHPFCRFFCahn-Hilliard residual for the RFF form of the phase field crystal model</li><li class="collection-item">CHSplitChemicalPotentialChemical potential kernel in Split Cahn-Hilliard that solves chemical potential in a weak form</li><li class="collection-item">CHSplitConcentrationConcentration kernel in Split Cahn-Hilliard that solves chemical potential in a weak form</li><li class="collection-item">CHSplitFluxComputes flux <span class="moose-katex-inline-equation" id="moose-equation-386acfc5-4bc3-441b-8c39-e0ab43007ec3"><script>var element = document.getElementById("moose-equation-386acfc5-4bc3-441b-8c39-e0ab43007ec3");katex.render("j", element, {displayMode:false,throwOnError:false});</script></span> as nodal variable <span class="moose-katex-inline-equation" id="moose-equation-bf78d15f-c026-43f6-9a15-ee91ddce79c7"><script>var element = document.getElementById("moose-equation-bf78d15f-c026-43f6-9a15-ee91ddce79c7");katex.render("j = -M\\nabla\\mu", element, {displayMode:false,throwOnError:false});</script></span></li><li class="collection-item">CahnHilliardCahn-Hilliard Kernel that uses a DerivativeMaterial Free Energy and a scalar (isotropic) mobility</li><li class="collection-item">CahnHilliardAnisoCahn-Hilliard Kernel that uses a DerivativeMaterial Free Energy and a tensor (anisotropic) mobility</li><li class="collection-item">CoefCoupledTimeDerivativeScaled time derivative Kernel that acts on a coupled variable</li><li class="collection-item">ConservedLangevinNoiseSource term for noise from a ConservedNoise userobject</li><li class="collection-item">CoupledAllenCahnCoupled Allen-Cahn Kernel that uses a DerivativeMaterial Free Energy</li><li class="collection-item">CoupledMaterialDerivativeKernel that implements the first derivative of a function material property with respect to a coupled variable.</li><li class="collection-item">CoupledSusceptibilityTimeDerivativeA modified coupled time derivative Kernel that multiplies the time derivative of a coupled variable by a generalized susceptibility</li><li class="collection-item">CoupledSwitchingTimeDerivativeCoupled time derivative Kernel that multiplies the time derivative by <span class="moose-katex-inline-equation" id="moose-equation-5959941c-169f-4a76-9b2c-01b3fc658fbc"><script>var element = document.getElementById("moose-equation-5959941c-169f-4a76-9b2c-01b3fc658fbc");katex.render("\\frac{dh_\\alpha}{d\\eta_i} F_\\alpha + \\frac{dh_\\beta}{d\\eta_i} F_\\beta + \\dots", element, {displayMode:false,throwOnError:false});</script></span></li><li class="collection-item">DiscreteNucleationForceTerm for inserting grain nuclei or phases in non-conserved order parameter fields</li><li class="collection-item">GradientComponentSet the kernel variable to a specified component of the gradient of a coupled variable.</li><li class="collection-item">HHPFCRFFReaction type kernel for the RFF phase fit crystal model</li><li class="collection-item">KKSACBulkCKKS model kernel (part 2 of 2) for the Bulk Allen-Cahn. This includes all terms dependent on chemical potential.</li><li class="collection-item">KKSACBulkFKKS model kernel (part 1 of 2) for the Bulk Allen-Cahn. This includes all terms NOT dependent on chemical potential.</li><li class="collection-item">KKSCHBulkKKS model kernel for the Bulk Cahn-Hilliard term. This operates on the concentration &#x27;c&#x27; as the non-linear variable</li><li class="collection-item">KKSMultiACBulkCMulti-phase KKS model kernel (part 2 of 2) for the Bulk Allen-Cahn. This includes all terms dependent on chemical potential.</li><li class="collection-item">KKSMultiACBulkFKKS model kernel (part 1 of 2) for the Bulk Allen-Cahn. This includes all terms NOT dependent on chemical potential.</li><li class="collection-item">KKSMultiPhaseConcentrationKKS multi-phase model kernel to enforce <span class="moose-katex-inline-equation" id="moose-equation-9a0c8aa8-9fb0-4545-b625-21536b387f54"><script>var element = document.getElementById("moose-equation-9a0c8aa8-9fb0-4545-b625-21536b387f54");katex.render("c = h_1c_1 + h_2c_2 + h_3c_3 + \\dots", element, {displayMode:false,throwOnError:false});</script></span>. The non-linear variable of this kernel is <span class="moose-katex-inline-equation" id="moose-equation-f23e82a7-0b9b-44df-bfaa-ac734ae9c43c"><script>var element = document.getElementById("moose-equation-f23e82a7-0b9b-44df-bfaa-ac734ae9c43c");katex.render("c_n", element, {displayMode:false,throwOnError:false});</script></span>, the final phase concentration in the list.</li><li class="collection-item">KKSPhaseChemicalPotentialKKS model kernel to enforce the pointwise equality of phase chemical potentials <span class="moose-katex-inline-equation" id="moose-equation-1c4cb614-d938-44fe-833e-c70603a41bed"><script>var element = document.getElementById("moose-equation-1c4cb614-d938-44fe-833e-c70603a41bed");katex.render("dF_a/dc_a = dF_b/dc_b", element, {displayMode:false,throwOnError:false});</script></span>. The non-linear variable of this kernel is <span class="moose-katex-inline-equation" id="moose-equation-737c43a6-a66b-4308-9c31-591582276bef"><script>var element = document.getElementById("moose-equation-737c43a6-a66b-4308-9c31-591582276bef");katex.render("c_a", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">KKSPhaseConcentrationKKS model kernel to enforce the decomposition of concentration into phase concentration  <span class="moose-katex-inline-equation" id="moose-equation-fbd77c68-ed72-4057-a2c1-f240e42f6315"><script>var element = document.getElementById("moose-equation-fbd77c68-ed72-4057-a2c1-f240e42f6315");katex.render("(1-h(\\eta))c_a + h(\\eta)c_b - c = 0", element, {displayMode:false,throwOnError:false});</script></span>. The non-linear variable of this kernel is <span class="moose-katex-inline-equation" id="moose-equation-f1b37736-e86b-4ac5-a511-802a09886d11"><script>var element = document.getElementById("moose-equation-f1b37736-e86b-4ac5-a511-802a09886d11");katex.render("c_b", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">KKSSplitCHCResKKS model kernel for the split Bulk Cahn-Hilliard term. This kernel operates on the physical concentration &#x27;c&#x27; as the non-linear variable</li><li class="collection-item">LangevinNoiseSource term for non-conserved Langevin noise</li><li class="collection-item">LaplacianSplitSplit with a variable that holds the Laplacian of a phase field variable.</li><li class="collection-item">MaskedBodyForceKernel that defines a body force modified by a material mask</li><li class="collection-item">MatAnisoDiffusionDiffusion equation Kernel that takes an anisotropic Diffusivity from a material property</li><li class="collection-item">MatGradSquareCoupledGradient square of a coupled variable.</li><li class="collection-item">MultiGrainRigidBodyMotionAdds rigid body motion to grains</li><li class="collection-item">SimpleACInterfaceGradient energy for Allen-Cahn Kernel with constant Mobility and Interfacial parameter</li><li class="collection-item">SimpleCHInterfaceGradient energy for Cahn-Hilliard equation with constant Mobility and Interfacial parameter</li><li class="collection-item">SimpleCoupledACInterfaceGradient energy for Allen-Cahn Kernel with constant Mobility and Interfacial parameter for a coupled order parameter variable.</li><li class="collection-item">SimpleSplitCHWResGradient energy for split Cahn-Hilliard equation with constant Mobility for a coupled order parameter variable.</li><li class="collection-item">SingleGrainRigidBodyMotionAdds rigid mody motion to a single grain</li><li class="collection-item">SoretDiffusionAdd Soret effect to Split formulation Cahn-Hilliard Kernel</li><li class="collection-item">SplitCHMathSimple demonstration split formulation Cahn-Hilliard Kernel using an algebraic double-well potential</li><li class="collection-item">SplitCHParsedSplit formulation Cahn-Hilliard Kernel that uses a DerivativeMaterial Free Energy</li><li class="collection-item">SplitCHWResSplit formulation Cahn-Hilliard Kernel for the chemical potential variable with a scalar (isotropic) mobility</li><li class="collection-item">SplitCHWResAnisoSplit formulation Cahn-Hilliard Kernel for the chemical potential variable with a tensor (anisotropic) mobility</li><li class="collection-item">SusceptibilityTimeDerivativeA modified time derivative Kernel that multiplies the time derivative of a variable by a generalized susceptibility</li><li class="collection-item">SwitchingFunctionConstraintEtaLagrange multiplier kernel to constrain the sum of all switching functions in a multiphase system. This kernel acts on a non-conserved order parameter eta_i.</li><li class="collection-item">SwitchingFunctionConstraintLagrangeLagrange multiplier kernel to constrain the sum of all switching functions in a multiphase system. This kernel acts on the Lagrange multiplier variable.</li><li class="collection-item">SwitchingFunctionPenaltyPenalty kernel to constrain the sum of all switching functions in a multiphase system.</li><li class="collection-header">Tensor Mechanics App</li><li class="collection-item">ADDynamicStressDivergenceTensorsResidual due to stress related Rayleigh damping and HHT time integration terms</li><li class="collection-item">ADGravityApply gravity. Value is in units of acceleration.</li><li class="collection-item">ADInertialForceCalculates the residual for the inertial force (<span class="moose-katex-inline-equation" id="moose-equation-9e7854ad-c48e-4695-aff5-f2973ccbc24f"><script>var element = document.getElementById("moose-equation-9e7854ad-c48e-4695-aff5-f2973ccbc24f");katex.render("M \\cdot acceleration", element, {displayMode:false,throwOnError:false});</script></span>) and the contribution of mass dependent Rayleigh damping and HHT time  integration scheme ($\eta \cdot M \cdot ((1+\alpha)velq2-\alpha \cdot vel-old) $)</li><li class="collection-item">ADInertialForceShellCalculates the residual for the inertial force/moment and the contribution of mass dependent Rayleigh damping and HHT time integration scheme.</li><li class="collection-item">ADStressDivergenceRSphericalTensorsCalculate stress divergence for a spherically symmetric 1D problem in polar coordinates.</li><li class="collection-item">ADStressDivergenceRZTensorsCalculate stress divergence for an axisymmetric problem in cylindrical coordinates.</li><li class="collection-item">ADStressDivergenceShellQuasi-static stress divergence kernel for Shell element</li><li class="collection-item">ADStressDivergenceTensorsStress divergence kernel with automatic differentiation for the Cartesian coordinate system</li><li class="collection-item">ADWeakPlaneStressPlane stress kernel to provide out-of-plane strain contribution.</li><li class="collection-item">AsymptoticExpansionHomogenizationKernelKernel for asymptotic expansion homogenization for elasticity</li><li class="collection-item">CosseratStressDivergenceTensorsStress divergence kernel for the Cartesian coordinate system</li><li class="collection-item">DynamicStressDivergenceTensorsResidual due to stress related Rayleigh damping and HHT time integration terms </li><li class="collection-item">GeneralizedPlaneStrainOffDiagGeneralized Plane Strain kernel to provide contribution of the out-of-plane strain to other kernels</li><li class="collection-item">GravityApply gravity. Value is in units of acceleration.</li><li class="collection-item">InertialForceCalculates the residual for the inertial force (<span class="moose-katex-inline-equation" id="moose-equation-b84d6948-d848-4a3a-b0ef-5b3adc52eec0"><script>var element = document.getElementById("moose-equation-b84d6948-d848-4a3a-b0ef-5b3adc52eec0");katex.render("M \\cdot acceleration", element, {displayMode:false,throwOnError:false});</script></span>) and the contribution of mass dependent Rayleigh damping and HHT time  integration scheme ($\eta \cdot M \cdot ((1+\alpha)velq2-\alpha \cdot vel-old) $)</li><li class="collection-item">InertialForceBeamCalculates the residual for the inertial force/moment and the contribution of mass dependent Rayleigh damping and HHT time integration scheme.</li><li class="collection-item">InertialTorqueKernel for inertial torque: density * displacement x acceleration</li><li class="collection-item">MaterialVectorBodyForceApply a body force vector to the coupled displacement component.</li><li class="collection-item">MomentBalancing</li><li class="collection-item">OutOfPlanePressureApply pressure in the out-of-plane direction in 2D plane stress or generalized plane strain models </li><li class="collection-item">PhaseFieldFractureMechanicsOffDiagStress divergence kernel for phase-field fracture: Computes off diagonal damage dependent Jacobian components. To be used with StressDivergenceTensors or DynamicStressDivergenceTensors.</li><li class="collection-item">PlasticHeatEnergyPlastic heat energy density = coeff * stress * plastic_strain_rate</li><li class="collection-item">PoroMechanicsCouplingAdds <span class="moose-katex-inline-equation" id="moose-equation-25c3fe72-e7b0-41f6-be46-9d5c11a1d887"><script>var element = document.getElementById("moose-equation-25c3fe72-e7b0-41f6-be46-9d5c11a1d887");katex.render("-Bi \\cdot p_s \\cdot \\nabla \\Psi_c", element, {displayMode:false,throwOnError:false});</script></span>, where the subscript <span class="moose-katex-inline-equation" id="moose-equation-38e67d6d-26bf-4bac-add7-2d71b4aa336b"><script>var element = document.getElementById("moose-equation-38e67d6d-26bf-4bac-add7-2d71b4aa336b");katex.render("c", element, {displayMode:false,throwOnError:false});</script></span> is the component.</li><li class="collection-item">StressDivergenceBeamQuasi-static and dynamic stress divergence kernel for Beam element</li><li class="collection-item">StressDivergenceRSphericalTensorsCalculate stress divergence for a spherically symmetric 1D problem in polar coordinates.</li><li class="collection-item">StressDivergenceRZTensorsCalculate stress divergence for an axisymmetric problem in cylindrical coordinates.</li><li class="collection-item">StressDivergenceTensorsStress divergence kernel for the Cartesian coordinate system</li><li class="collection-item">StressDivergenceTensorsTrussKernel for truss element</li><li class="collection-item">WeakPlaneStressPlane stress kernel to provide out-of-plane strain contribution.</li><li class="collection-header">Navier Stokes App</li><li class="collection-item">DistributedForceImplements a force term in the Navier Stokes momentum equation.</li><li class="collection-item">DistributedPowerImplements the power term of a specified force in the Navier Stokes energy equation.</li><li class="collection-item">INSADBoussinesqBodyForceComputes a body force for natural convection buoyancy.</li><li class="collection-item">INSADEnergyAdvectionThis class computes the residual and Jacobian contributions for temperature advection for a divergence free velocity field.</li><li class="collection-item">INSADEnergyAmbientConvectionComputes a heat source/sink due to convection from ambient surroundings.</li><li class="collection-item">INSADEnergySUPGAdds the supg stabilization to the INS temperature/energy equation</li><li class="collection-item">INSADEnergySourceComputes an arbitrary volumetric heat source (or sink).</li><li class="collection-item">INSADGravityForceComputes a body force due to gravity.</li><li class="collection-item">INSADHeatConductionTimeDerivativeAD Time derivative term <span class="moose-katex-inline-equation" id="moose-equation-b10a5e1d-d24f-495e-b3b3-e87ba242dff3"><script>var element = document.getElementById("moose-equation-b10a5e1d-d24f-495e-b3b3-e87ba242dff3");katex.render("\\rho c_p \\frac{\\partial T}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span> of the heat equation for quasi-constant specific heat <span class="moose-katex-inline-equation" id="moose-equation-09eb3980-89fe-4ff7-8380-e5312c15366e"><script>var element = document.getElementById("moose-equation-09eb3980-89fe-4ff7-8380-e5312c15366e");katex.render("c_p", element, {displayMode:false,throwOnError:false});</script></span> and the density <span class="moose-katex-inline-equation" id="moose-equation-355bfde2-a6d3-4820-8d91-8fc15af5b47f"><script>var element = document.getElementById("moose-equation-355bfde2-a6d3-4820-8d91-8fc15af5b47f");katex.render("\\rho", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">INSADMassThis class computes the mass equation residual and Jacobian contributions (the latter using automatic differentiation) for the incompressible Navier-Stokes equations.</li><li class="collection-item">INSADMassPSPGThis class adds PSPG stabilization to the mass equation, enabling use of equal order shape functions for pressure and velocity variables</li><li class="collection-item">INSADMomentumAdvectionAdds the advective term to the INS momentum equation</li><li class="collection-item">INSADMomentumCoupledForceComputes a body force due to a coupled vector variable or a vector function</li><li class="collection-item">INSADMomentumPressureAdds the pressure term to the INS momentum equation</li><li class="collection-item">INSADMomentumSUPGAdds the supg stabilization to the INS momentum equation</li><li class="collection-item">INSADMomentumTimeDerivativeThis class computes the time derivative for the incompressible Navier-Stokes momentum equation.</li><li class="collection-item">INSADMomentumViscousAdds the viscous term to the INS momentum equation</li><li class="collection-item">INSADSmagorinskyEddyViscosityComputes eddy viscosity term using Smagorinky&#x27;s LES model</li><li class="collection-item">INSChorinCorrectorThis class computes the &#x27;Chorin&#x27; Corrector equation in fully-discrete (both time and space) form.</li><li class="collection-item">INSChorinPredictorThis class computes the &#x27;Chorin&#x27; Predictor equation in fully-discrete (both time and space) form.</li><li class="collection-item">INSChorinPressurePoissonThis class computes the pressure Poisson solve which is part of the &#x27;split&#x27; scheme used for solving the incompressible Navier-Stokes equations.</li><li class="collection-item">INSCompressibilityPenaltyThe penalty term may be used when Dirichlet boundary condition is applied to the entire boundary.</li><li class="collection-item">INSMassThis class computes the mass equation residual and Jacobian contributions for the incompressible Navier-Stokes momentum equation.</li><li class="collection-item">INSMassRZThis class computes the mass equation residual and Jacobian contributions for the incompressible Navier-Stokes momentum equation in RZ coordinates.</li><li class="collection-item">INSMomentumLaplaceFormThis class computes momentum equation residual and Jacobian viscous contributions for the &#x27;Laplacian&#x27; form of the governing equations.</li><li class="collection-item">INSMomentumLaplaceFormRZThis class computes additional momentum equation residual and Jacobian contributions for the incompressible Navier-Stokes momentum equation in RZ (axisymmetric cylindrical) coordinates, using the &#x27;Laplace&#x27; form of the governing equations.</li><li class="collection-item">INSMomentumTimeDerivativeThis class computes the time derivative for the incompressible Navier-Stokes momentum equation.</li><li class="collection-item">INSMomentumTractionFormThis class computes momentum equation residual and Jacobian viscous contributions for the &#x27;traction&#x27; form of the governing equations.</li><li class="collection-item">INSMomentumTractionFormRZThis class computes additional momentum equation residual and Jacobian contributions for the incompressible Navier-Stokes momentum equation in RZ (axisymmetric cylindrical) coordinates.</li><li class="collection-item">INSPressurePoissonThis class computes the pressure Poisson solve which is part of the &#x27;split&#x27; scheme used for solving the incompressible Navier-Stokes equations.</li><li class="collection-item">INSProjectionThis class computes the &#x27;projection&#x27; part of the &#x27;split&#x27; method for solving incompressible Navier-Stokes.</li><li class="collection-item">INSSplitMomentumThis class computes the &#x27;split&#x27; momentum equation residual.</li><li class="collection-item">INSTemperatureThis class computes the residual and Jacobian contributions for the incompressible Navier-Stokes temperature (energy) equation.</li><li class="collection-item">INSTemperatureTimeDerivativeThis class computes the time derivative for the incompressible Navier-Stokes momentum equation.</li><li class="collection-item">MassConvectiveFluxImplements the advection term for the Navier Stokes mass equation.</li><li class="collection-item">MomentumConvectiveFluxImplements the advective term of the Navier Stokes momentum equation.</li><li class="collection-item">NSEnergyInviscidFluxThis class computes the inviscid part of the energy flux.</li><li class="collection-item">NSEnergyThermalFluxThis class is responsible for computing residuals and Jacobian terms for the k * grad(T) * grad(phi) term in the Navier-Stokes energy equation.</li><li class="collection-item">NSEnergyViscousFluxViscous flux terms in energy equation.</li><li class="collection-item">NSGravityForceThis class computes the gravity force contribution.</li><li class="collection-item">NSGravityPowerThis class computes the momentum contributed by gravity.</li><li class="collection-item">NSMassInviscidFluxThis class computes the inviscid flux in the mass equation.</li><li class="collection-item">NSMomentumInviscidFluxThe inviscid flux (convective + pressure terms) for the momentum conservation equations.</li><li class="collection-item">NSMomentumInviscidFluxWithGradPThis class computes the inviscid flux with pressure gradient in the momentum equation.</li><li class="collection-item">NSMomentumViscousFluxDerived instance of the NSViscousFluxBase class for the momentum equations.</li><li class="collection-item">NSSUPGEnergyCompute residual and Jacobian terms form the SUPG terms in the energy equation.</li><li class="collection-item">NSSUPGMassCompute residual and Jacobian terms form the SUPG terms in the mass equation.</li><li class="collection-item">NSSUPGMomentumCompute residual and Jacobian terms form the SUPG terms in the momentum equation.</li><li class="collection-item">NSTemperatureL2This class was originally used to solve for the temperature using an L2-projection.</li><li class="collection-item">PressureGradientImplements the pressure gradient term for one of the Navier Stokes momentum equations.</li><li class="collection-item">TotalEnergyConvectiveFluxImplements the advection term for the Navier Stokes energy equation.</li><li class="collection-header">Squirrel App</li><li class="collection-item">ConservativeTemperatureAdvectionConservative form of <span class="moose-katex-inline-equation" id="moose-equation-ff6966a0-3ee9-41bb-b4d5-b450b55bb600"><script>var element = document.getElementById("moose-equation-ff6966a0-3ee9-41bb-b4d5-b450b55bb600");katex.render("\\nabla \\cdot \\vec{v} u", element, {displayMode:false,throwOnError:false});</script></span> which in its weak form is given by: <span class="moose-katex-inline-equation" id="moose-equation-a0e60fbb-4dae-450d-a417-c23c7c9b3449"><script>var element = document.getElementById("moose-equation-a0e60fbb-4dae-450d-a417-c23c7c9b3449");katex.render("(-\\nabla \\psi_i, \\vec{v} u)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">CtrlConservativeAdvection</li><li class="collection-item">CtrlConservativeTemperatureAdvection</li><li class="collection-item">MatINSTemperatureTimeDerivativeThe time derivative operator with the weak form of <span class="moose-katex-inline-equation" id="moose-equation-5a69773c-42b3-4f9d-8da3-f4cefade1332"><script>var element = document.getElementById("moose-equation-5a69773c-42b3-4f9d-8da3-f4cefade1332");katex.render("(\\psi_i, \\frac{\\partial u_h}{\\partial t})", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">NonConservativeAdvection</li><li class="collection-item">PotentialAdvection</li><li class="collection-item">VelocityFunctionTemperatureAdvection</li><li class="collection-header">Heat Conduction App</li><li class="collection-item">ADHeatConductionSame as <code>Diffusion</code> in terms of physics/residual, but the Jacobian is computed using forward automatic differentiation</li><li class="collection-item">ADHeatConductionTimeDerivativeAD Time derivative term <span class="moose-katex-inline-equation" id="moose-equation-b7794899-82d4-4b8f-85e7-87b1fa01e082"><script>var element = document.getElementById("moose-equation-b7794899-82d4-4b8f-85e7-87b1fa01e082");katex.render("\\rho c_p \\frac{\\partial T}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span> of the heat equation for quasi-constant specific heat <span class="moose-katex-inline-equation" id="moose-equation-251f142a-b675-481b-ac1c-34df17dae65a"><script>var element = document.getElementById("moose-equation-251f142a-b675-481b-ac1c-34df17dae65a");katex.render("c_p", element, {displayMode:false,throwOnError:false});</script></span> and the density <span class="moose-katex-inline-equation" id="moose-equation-a10a5e1f-3250-44aa-b934-940aa2bfd53f"><script>var element = document.getElementById("moose-equation-a10a5e1f-3250-44aa-b934-940aa2bfd53f");katex.render("\\rho", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">ADJouleHeatingSourceCalculates the heat source term corresponding to electrostatic Joule heating, with Jacobian contributions calculated using the automatic differentiation system.</li><li class="collection-item">ADMatHeatSourceForce term in thermal transport to represent a heat source</li><li class="collection-item">AnisoHeatConductionAnisotropic HeatConduction kernel <span class="moose-katex-inline-equation" id="moose-equation-9d39b6e4-4a35-4222-825f-7a2218f837ce"><script>var element = document.getElementById("moose-equation-9d39b6e4-4a35-4222-825f-7a2218f837ce");katex.render("\\nabla \\cdot -\\widetilde{k} \\nabla u", element, {displayMode:false,throwOnError:false});</script></span> with weak form given by <span class="moose-katex-inline-equation" id="moose-equation-eba2ec22-e4cc-47ad-a95f-5c704d1c4116"><script>var element = document.getElementById("moose-equation-eba2ec22-e4cc-47ad-a95f-5c704d1c4116");katex.render("(\\nabla \\psi_i, \\widetilde{k} \\nabla u)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">HeatCapacityConductionTimeDerivativeTime derivative term <span class="moose-katex-inline-equation" id="moose-equation-6b59a553-5a16-43e4-827c-f6f5ed6fbb17"><script>var element = document.getElementById("moose-equation-6b59a553-5a16-43e4-827c-f6f5ed6fbb17");katex.render("C_p \\frac{\\partial T}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span> of the heat equation with the heat capacity <span class="moose-katex-inline-equation" id="moose-equation-1c1889c1-af14-48db-a55a-a01765723903"><script>var element = document.getElementById("moose-equation-1c1889c1-af14-48db-a55a-a01765723903");katex.render("C_p", element, {displayMode:false,throwOnError:false});</script></span> as an argument.</li><li class="collection-item">HeatConductionComputes residual/Jacobian contribution for <span class="moose-katex-inline-equation" id="moose-equation-5a897104-bb3c-4daf-bab1-20753db13887"><script>var element = document.getElementById("moose-equation-5a897104-bb3c-4daf-bab1-20753db13887");katex.render("(k \\nabla T, \\nabla \\psi)", element, {displayMode:false,throwOnError:false});</script></span> term.</li><li class="collection-item">HeatConductionTimeDerivativeTime derivative term <span class="moose-katex-inline-equation" id="moose-equation-f9d03b8e-2034-4e27-91b5-0b63d35900b4"><script>var element = document.getElementById("moose-equation-f9d03b8e-2034-4e27-91b5-0b63d35900b4");katex.render("\\rho c_p \\frac{\\partial T}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span> of the heat equation for quasi-constant specific heat <span class="moose-katex-inline-equation" id="moose-equation-b2997a81-5314-4a55-b2d3-95e072559500"><script>var element = document.getElementById("moose-equation-b2997a81-5314-4a55-b2d3-95e072559500");katex.render("c_p", element, {displayMode:false,throwOnError:false});</script></span> and the density <span class="moose-katex-inline-equation" id="moose-equation-b38fffd4-12c5-4140-aa77-4716c32a69a8"><script>var element = document.getElementById("moose-equation-b38fffd4-12c5-4140-aa77-4716c32a69a8");katex.render("\\rho", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">HeatSourceDemonstrates the multiple ways that scalar values can be introduced into kernels, e.g. (controllable) constants, functions, and postprocessors. Implements the weak form <span class="moose-katex-inline-equation" id="moose-equation-1c86204e-402b-42a3-86f0-6c466c2db0ea"><script>var element = document.getElementById("moose-equation-1c86204e-402b-42a3-86f0-6c466c2db0ea");katex.render("(\\psi_i, -f)", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item">HomogenizedHeatConductionKernel for asymptotic expansion homogenization for thermal conductivity</li><li class="collection-item">JouleHeatingSourceCalculates the heat source term corresponding to electrostatic Joule heating.</li><li class="collection-item">SpecificHeatConductionTimeDerivativeTime derivative term <span class="moose-katex-inline-equation" id="moose-equation-8112547c-3d1a-4241-af67-ee14e6038ca5"><script>var element = document.getElementById("moose-equation-8112547c-3d1a-4241-af67-ee14e6038ca5");katex.render("\\rho c_p \\frac{\\partial T}{\\partial t}", element, {displayMode:false,throwOnError:false});</script></span> of the heat equation with the specific heat <span class="moose-katex-inline-equation" id="moose-equation-ed819f28-b6ab-45c7-94f9-3ce1eb56ec14"><script>var element = document.getElementById("moose-equation-ed819f28-b6ab-45c7-94f9-3ce1eb56ec14");katex.render("c_p", element, {displayMode:false,throwOnError:false});</script></span> and the density <span class="moose-katex-inline-equation" id="moose-equation-a9803296-042d-4cfb-8a1f-218f79572345"><script>var element = document.getElementById("moose-equation-a9803296-042d-4cfb-8a1f-218f79572345");katex.render("\\rho", element, {displayMode:false,throwOnError:false});</script></span> as arguments.</li><li class="collection-header">Moltres App</li><li class="collection-item"><a href="../../source/kernels/ConvectiveHeatExchanger.html">ConvectiveHeatExchanger</a>A uniformly applied heat removal proportional to a differencefrom a nominal temperature. A global heat exchanger.</li><li class="collection-item"><a href="../../source/kernels/CoupledFissionEigenKernel.html">CoupledFissionEigenKernel</a></li><li class="collection-item"><a href="../../source/kernels/CoupledFissionKernel.html">CoupledFissionKernel</a></li><li class="collection-item"><a href="../../source/kernels/CoupledScalarAdvection.html">CoupledScalarAdvection</a></li><li class="collection-item"><a href="../../source/kernels/DecayHeatSource.html">DecayHeatSource</a></li><li class="collection-item"><a href="../../source/kernels/DelayedNeutronEigenSource.html">DelayedNeutronEigenSource</a></li><li class="collection-item"><a href="../../source/kernels/DelayedNeutronSource.html">DelayedNeutronSource</a></li><li class="collection-item"><a href="../../source/kernels/DivFreeCoupledScalarAdvection.html">DivFreeCoupledScalarAdvection</a></li><li class="collection-item"><a href="../../source/kernels/FissionHeatSource.html">FissionHeatSource</a></li><li class="collection-item"><a href="../../source/kernels/GammaHeatSource.html">GammaHeatSource</a></li><li class="collection-item"><a href="../../source/kernels/GroupDiffusion.html">GroupDiffusion</a></li><li class="collection-item"><a href="../../source/kernels/HeatPrecursorDecay.html">HeatPrecursorDecay</a></li><li class="collection-item"><a href="../../source/kernels/HeatPrecursorSource.html">HeatPrecursorSource</a></li><li class="collection-item"><a href="../../source/kernels/INSBoussinesqBodyForce.html">INSBoussinesqBodyForce</a>Computes a body force for natural convection buoyancy.</li><li class="collection-item"><a href="../../source/kernels/INSMomentumKEpsilon.html">INSMomentumKEpsilon</a></li><li class="collection-item"><a href="../../source/kernels/InScatter.html">InScatter</a></li><li class="collection-item"><a href="../../source/kernels/NtTimeDerivative.html">NtTimeDerivative</a></li><li class="collection-item"><a href="../../source/kernels/PrecursorDecay.html">PrecursorDecay</a></li><li class="collection-item"><a href="../../source/kernels/PrecursorSource.html">PrecursorSource</a></li><li class="collection-item"><a href="../../source/kernels/ScalarAdvectionArtDiff.html">ScalarAdvectionArtDiff</a>This class computes the residual and Jacobian contributions from the artificial diffusion term, <span class="moose-katex-inline-equation" id="moose-equation-c893f857-a3ae-41f2-9c5f-b6955c605589"><script>var element = document.getElementById("moose-equation-c893f857-a3ae-41f2-9c5f-b6955c605589");katex.render("D' = \\tau |u| \\Delta x / 2", element, {displayMode:false,throwOnError:false});</script></span>.</li><li class="collection-item"><a href="../../source/kernels/ScalarTransportTimeDerivative.html">ScalarTransportTimeDerivative</a></li><li class="collection-item"><a href="../../source/kernels/SelfFissionEigenKernel.html">SelfFissionEigenKernel</a></li><li class="collection-item"><a href="../../source/kernels/SigmaR.html">SigmaR</a></li><li class="collection-item"><a href="../../source/kernels/TransientFissionHeatSource.html">TransientFissionHeatSource</a></li></ul></section></section><div class="moose-modal modal" id="e85f7fb2-b84a-4ed8-a15d-52c8eed75e5d"><div class="modal-content"><h4>(moose/framework/src/kernels/Diffusion.C)</h4><pre class="moose-pre"><code class="language-cpp">// This file is part of the MOOSE framework
// https://www.mooseframework.org
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;Diffusion.h&quot;

registerMooseObject(&quot;MooseApp&quot;, Diffusion);

defineLegacyParams(Diffusion);

InputParameters
Diffusion::validParams()
{
  InputParameters params = Kernel::validParams();
  params.addClassDescription(&quot;The Laplacian operator ($-\\nabla \\cdot \\nabla u$), with the weak &quot;
                             &quot;form of $(\\nabla \\phi_i, \\nabla u_h)$.&quot;);
  return params;
}

Diffusion::Diffusion(const InputParameters &amp; parameters) : Kernel(parameters) {}

Real
Diffusion::computeQpResidual()
{
  return _grad_u[_qp] * _grad_test[_i][_qp];
}

Real
Diffusion::computeQpJacobian()
{
  return _grad_phi[_j][_qp] * _grad_test[_i][_qp];
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="c3865413-beff-40dc-b386-7572d41c8e0b"><div class="modal-content"><h4>(doc/jacobian)</h4><pre class="moose-pre"><code class="language-text">[Tests]
  # Needed because the default of false will cause the
  # race condition checks to be skipped
  parallel_scheduling = true

  [./a]
    type = &#x27;AnalyzeJacobian&#x27;
    input = &#x27;good.i&#x27;
  [../]
  [./b]
    type = &#x27;AnalyzeJacobian&#x27;
    input = &#x27;good.i&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="7f5f688e-ab57-49a5-bb49-cc7e07a0965c"><div class="modal-content"><h4>(doc/jacobian)</h4><pre class="moose-pre"><code class="language-text">[Tests]
  # Needed because the default of false will cause the
  # race condition checks to be skipped
  parallel_scheduling = true

  [./a]
    type = &#x27;AnalyzeJacobian&#x27;
    input = &#x27;good.i&#x27;
  [../]
  [./b]
    type = &#x27;AnalyzeJacobian&#x27;
    input = &#x27;good.i&#x27;
  [../]
[]
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="af5ff740-156d-426c-b4c7-0580d797062e"><div class="modal-content"><h4>(moose/framework/src/kernels/Diffusion.C)</h4><pre class="moose-pre"><code class="language-cpp">// This file is part of the MOOSE framework
// https://www.mooseframework.org
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;Diffusion.h&quot;

registerMooseObject(&quot;MooseApp&quot;, Diffusion);

defineLegacyParams(Diffusion);

InputParameters
Diffusion::validParams()
{
  InputParameters params = Kernel::validParams();
  params.addClassDescription(&quot;The Laplacian operator ($-\\nabla \\cdot \\nabla u$), with the weak &quot;
                             &quot;form of $(\\nabla \\phi_i, \\nabla u_h)$.&quot;);
  return params;
}

Diffusion::Diffusion(const InputParameters &amp; parameters) : Kernel(parameters) {}

Real
Diffusion::computeQpResidual()
{
  return _grad_u[_qp] * _grad_test[_i][_qp];
}

Real
Diffusion::computeQpJacobian()
{
  return _grad_phi[_j][_qp] * _grad_test[_i][_qp];
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div><div class="moose-modal modal" id="f04cdc76-318c-414e-a573-18fe4daf87cc"><div class="modal-content"><h4>(moose/framework/src/kernels/ADDiffusion.C)</h4><pre class="moose-pre"><code class="language-cpp">// This file is part of the MOOSE framework
// https://www.mooseframework.org
//
// All rights reserved, see COPYRIGHT for full restrictions
// https://github.com/idaholab/moose/blob/master/COPYRIGHT
//
// Licensed under LGPL 2.1, please see LICENSE for details
// https://www.gnu.org/licenses/lgpl-2.1.html

#include &quot;ADDiffusion.h&quot;

registerMooseObject(&quot;MooseApp&quot;, ADDiffusion);

InputParameters
ADDiffusion::validParams()
{
  auto params = ADKernelGrad::validParams();
  params.addClassDescription(&quot;Same as `Diffusion` in terms of physics/residual, but the Jacobian &quot;
                             &quot;is computed using forward automatic differentiation&quot;);
  return params;
}

ADDiffusion::ADDiffusion(const InputParameters &amp; parameters) : ADKernelGrad(parameters) {}

ADRealVectorValue
ADDiffusion::precomputeQpResidual()
{
  return _grad_u[_qp];
}
</code></pre></div><div class="modal-footer"><a class="modal-close btn-flat">Close</a></div></div></div><div class="col hide-on-med-and-down l2"><div class="toc-wrapper pin-top"><ul class="section table-of-contents"><li><a href="#88398ae7-09a4-4454-914b-bc7d2f5f1545" class="tooltipped" data-position="left" data-tooltip="Optimized Kernel Objects">Optimized Kernel Objects</a></li><li><a href="#3ee8c613-2269-43ec-bc7a-fd26fbdf1d87" class="tooltipped" data-position="left" data-tooltip="Custom Kernel Creation">Custom Kernel Creation</a></li><li><a href="#460b7891-8845-40b5-a730-87d1f89937f8" class="tooltipped" data-position="left" data-tooltip="Time Derivative Kernels">Time Derivative Kernels</a></li><li><a href="#f203d152-a590-4251-9265-fc193af42448" class="tooltipped" data-position="left" data-tooltip="Further Kernel Documentation">Further Kernel Documentation</a></li><li><a href="#20c22409-3962-4e61-8b3f-5775eda2a6b7" class="tooltipped" data-position="left" data-tooltip="Available Objects">Available Objects</a></li></ul></div></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="../../contrib/fuse/fuse.min.js"></script><script type="text/javascript" src="../../js/search_index.js"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>